<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>[LSS2021] DDD &gt; Strategic Patterns</title>

<meta name="author" content="Danilo Pianini">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="/Course-Laboratory-of-Software-Systems/reveal-js/css/reset.css">
<link rel="stylesheet" href="/Course-Laboratory-of-Software-Systems/reveal-js/css/reveal.css">
  <link rel="stylesheet" href="/Course-Laboratory-of-Software-Systems/css/custom-theme.min.1e2604bf0c24e445faa3ae7d68b2f0146c34bc9e7b9bd6aee2b7187115560e96.css" id="theme"><link rel="stylesheet" href="/Course-Laboratory-of-Software-Systems/highlight-js/default.min.css">
    
<link rel="stylesheet" href="https://gitcdn.link/repo/DanySK/css-blur-animation/master/blur.css">
<link href='https://fonts.googleapis.com/css?family=Roboto Mono' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Oxygen Mono' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Ubuntu Mono' rel='stylesheet'>

  </head>
  <body>
    <div class="reveal">
      <div class="slides">
  

    <section><h4 id="alma-mater-studiorum---università-di-bologna">Alma Mater Studiorum - Università di Bologna</h4>
<h4 id="computer-science-and-engineering-department-disi">Computer Science and Engineering Department (DISI)</h4>
<p> </p>
<h1 id="domain-driven-design">Domain-Driven Design</h1>
<h2 id="04---strategic-patterns">04 - Strategic Patterns</h2>
<p> </p>
<h4 id="a-croattimailtoacroattiuniboit"><a href="mailto:a.croatti@unibo.it">A. Croatti</a></h4>
<p> </p>
<h4 id="hahahugoshortcode-s0-hbhb">Laboratory of Software Systems</h4>
<h4 id="hahahugoshortcode-s1-hbhb">A.Y. 2020/2021</h4>
</section><section>
<h2 id="outline">Outline</h2>
<ol>
<li>
<p>Software Architectures for the DDD</p>
</li>
<li>
<p>Bounded Context Integration</p>
</li>
</ol>
</section><section>
<h1 id="software-architectures">Software Architectures</h1>
<h1 id="for-the-domain-driven-design">for the Domain-Driven Design</h1>
</section><section>
<h2 id="towards-a">Towards a</h2>
<h1 id="clean-architecture">Clean Architecture</h1>
<p>DDD does not enforce the use of a particular architectural style<br>
&hellip; as long as the chosen one <em>must support the isolation of the domain logic</em>!</p>
<ul>
<li>
<p>Several architectural styles can be used</p>
<ul>
<li>e.g. ubiquitous layered architecture, hexagonal architecture, &hellip;</li>
</ul>
</li>
<li>
<p>The Microservice Architectural Style is the closest one to the DDD philosophy</p>
</li>
</ul>
</section><section>
<div class='left' style='float:left;width:50%'>
<h2 id="a-revised-layered-architecture">A &ldquo;revised&rdquo; Layered Architecture</h2>
<ul>
<li>
<p>At the heart of the architecture there is the domain layer</p>
</li>
<li>
<p>Surrounding the domain layer there is an application layer</p>
<ul>
<li>It abstracts the low-level details of the domain behind a coarse-grained API</li>
<li>The APIs represent the business use cases of the application</li>
</ul>
</li>
<li>
<p>The domain logic and application layers are isolated and protected from the &ldquo;external&rdquo; accidental complexities</p>
</li>
</ul>
</div>
<div class='right' style='float:right;width:50%'>
<img src="assets/layered_architecture.png" style='
    
    
    max-width: 95vw;
    max-height: 80vh;
    object-fit: contain;
'>

</div>
</section><section>
<h1 id="dependency-inversion">Dependency Inversion</h1>
<div class='left' style='float:left;width:65%'>
<img src="assets/dependency-inversion.png" style='
    width: 65vw;
    
    max-width: 95vw;
    max-height: 80vh;
    object-fit: contain;
'>

</div>
<div class='right' style='float:right;width:35%'>
<ul>
<li>
<p>The domain layer and application layers at the center of the architecture should not depend on any other layers</p>
</li>
<li>
<p>The application layer is dependent only on the domain layer</p>
<ul>
<li>it orchestrates the handling of the use cases by delegating to the domain layer</li>
</ul>
</li>
</ul>
</div>
</section><section>
<h2 id="the-application-service-layer">The Application Service Layer</h2>
<ul>
<li>
<p><strong>Represents the use cases and behavior of the application</strong></p>
<ul>
<li>use cases are implemented as application services that contain application logic to coordinate the fulfillment of a use case by delegating to the domain and infrastructural layers</li>
</ul>
</li>
<li>
<p><strong>Operates at a higher level of abstraction than the domain objects</strong></p>
<ul>
<li>exposing a coarse-grained set of services while hiding the details of the domain layer (&quot;<em>what the system does, but not how it does it&rdquo;</em>)</li>
<li>is a facade for the domain model</li>
</ul>
</li>
<li>
<p><strong>Enables the support of different clients without compromising the domain layer&rsquo;s integrity</strong></p>
<ul>
<li>clients must adapt to the application layer APIs, transforming the output in a suitable format</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="the-infrastructural-layer">The Infrastructural Layer</h2>
<ul>
<li>
<p><strong>Contains all the technical details of the software system</strong></p>
<ul>
<li>such as enabling the application to be consumed, whether by humans via a user interface or by applications via a set of web service or message endpoints</li>
<li>is responsible for the technical implementation of storing information on the state of domain objects</li>
</ul>
</li>
<li>
<p>Can provide capabilities for logging, security, notification, and integration with other bounded contexts and applications</p>
</li>
</ul>
</section><section>
<div class='left' style='float:left;width:50%'>
<h1 id="clean-architecture-1">Clean Architecture</h1>
<ol>
<li>Independent of Frameworks</li>
<li>Testable</li>
<li>Independent of the UI</li>
<li>Independent of the data persistence layer</li>
<li>Independent of any external agency</li>
</ol>
<blockquote>
<p><em>No &ldquo;name&rdquo; in an outer circle can be mentioned by an inner circle</em></p>
</blockquote>
</div>
<div class='right' style='float:right;width:50%'>
<img src="assets/CleanArchitecture.jpg" style='
    width: 40vw;
    
    max-width: 95vw;
    max-height: 80vh;
    object-fit: contain;
'>

<p>(from <em>Clean Architecture</em> by Robert C. Martin)</p>
</div>
</section><section>
<div class='left' style='float:left;width:50%'>
<h1 id="microservices-architecture">Microservices Architecture</h1>
<ul>
<li>
<p>Nowadays, an extremely popular architecture style</p>
<ul>
<li>&hellip; heavily inspired by DDD Bounded Context concept!</li>
</ul>
</li>
<li>
<p>The goal is to have a high level of decoupling</p>
<ul>
<li>Microservices favor duplication over reuse</li>
</ul>
</li>
</ul>
</div>
<div class='right' style='float:right;width:50%'>
<img src="assets/microservices_topology.png" style='
    width: 40vw;
    
    max-width: 95vw;
    max-height: 80vh;
    object-fit: contain;
'>

<p>(from <em>Fundamentals of Software Architecture</em><br>
by R. Richards and N. Ford)</p>
</div>
</section><section>
<h2 id="microservices-and-bounded-contexts">Microservices and Bounded Contexts</h2>
<ul>
<li>
<p>Each (micro)service models a domain/workflow</p>
<ul>
<li>Each service represents a bounded context&hellip;</li>
<li>&hellip; or more than one!</li>
</ul>
</li>
<li>
<p>Service Boundaries delineated according:</p>
<ul>
<li><em>Purpose</em> - each microservice should be extremely functionally cohesive</li>
<li><em>Transactions</em> - each microservice must reduce issues related to transaction collaboration among domain entities</li>
<li><em>Choreography</em> - excellent domain isolation might generate overhead in communications</li>
</ul>
</li>
<li>
<p>Data Isolation</p>
<ul>
<li>Avoid all kind of coupling, especially shared data schemas and databases (used as integration point)</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="sidecar-pattern-with-service-plane">Sidecar Pattern with Service Plane</h2>
<img src="assets/sidecar_pattern.png" style='
    
    
    max-width: 95vw;
    max-height: 80vh;
    object-fit: contain;
'>

</section><section>
<div class='left' style='float:left;width:50%'>
<p><em>For good architectures&hellip;</em></p>
<h1 id="be-pragmatic-yet-visionary">Be Pragmatic, Yet Visionary</h1>
<ul>
<li>
<p><em>Pragmatic</em> - Dealing with things sensibly and realistically in a way that is based on practical rather than theoretical considerations</p>
</li>
<li>
<p><em>Visionary</em> - Thinking about or planning the future with imagination or wisdom</p>
</li>
</ul>
</div>
<div class='right' style='float:right;width:50%'>
<img src="assets/pragmatic_visionary.png" style='
    width: 30vw;
    
    max-width: 95vw;
    max-height: 80vh;
    object-fit: contain;
'>

<p>(from <em>Fundamentals of Software Architecture</em><br>
by R. Richards and N. Ford)</p>
</div>
</section><section>
<h1 id="bounded-context-integration">Bounded Context Integration</h1>
</section><section>
<h1 id="the-issue">The Issue</h1>
<blockquote>
<p><em>After identifying the bounded contexts in your system the next step is to decide how you will integrate them to carry out full business use cases</em></p>
</blockquote>
<ul>
<li>
<p>Software services need to have <strong>relationships</strong> with each other to provide advanced behaviors</p>
<ul>
<li>relationships can reflect the domain and domain experts expectations</li>
<li>relationships may impact the scalability of the (distributed) system</li>
</ul>
</li>
<li>
<p>A good place where to start identifying relationships is by identifying your bounded contexts</p>
</li>
</ul>
</section><section>
<div class='left' style='float:left;width:50%'>
<h1 id="bounded-contexts">Bounded Contexts</h1>
<h1 id="must-be-autonomous">must be Autonomous</h1>
</div>
<div class='right' style='float:right;width:50%'>
<ul>
<li>
<p>As systems grow, dependencies become more significant in a negative way</p>
<ul>
<li>You should strive to avoid most forms of coupling unless you have a very good reason&hellip;</li>
</ul>
</li>
<li>
<p>A coupling on code means that one team can break another team’s code</p>
<ul>
<li>&hellip; or cause bottlenecks that slow down the delivery of new features!</li>
</ul>
</li>
<li>
<p>A runtime coupling between subsystems means that one system cannot function without the other</p>
</li>
</ul>
</div>
</section><section>
<h2 id="bunded-contexts-integration-at-the-code-level">Bunded Contexts Integration at the code level</h2>
<h2 id="to-be-avoided">(to be avoided)</h2>
<ul>
<li>
<p>Multiple Bounded Contexts within the same project</p>
<ul>
<li>Namespace/packages to enforce the separation</li>
<li>SRP vs. DRY: which one to prefer?</li>
</ul>
</li>
<li>
<p>Integration via a Shared Database</p>
<ul>
<li>Distinct domain concepts mapped to the same database concept with multiple attributes</li>
</ul>
</li>
<li>
<p>Multiple teams working in a single codebase</p>
<ul>
<li>Git Workflow is not a cure-all</li>
</ul>
</li>
<li>
<p>&hellip;</p>
</li>
</ul>
</section><section>
<h2 id="physical-boundaries">&ldquo;Physical&rdquo; Boundaries</h2>
<img src="assets/physical_boundaries.png" style='
    
    
    max-width: 95vw;
    max-height: 80vh;
    object-fit: contain;
'>

</section><section>
<div class='left' style='float:left;width:50%'>
<h2 id="integration-with-legacy-systems">Integration with Legacy Systems</h2>
<ul>
<li>
<p><em>Bubble Context</em></p>
<ul>
<li>An ad-hoc ACL mediates the communication among the bubble context and the legacy system</li>
</ul>
</li>
<li>
<p><em>Autonomous Bubble Context</em></p>
<ul>
<li>The ACL acts as a synchronization barrier, the interaction with the legacy system(s) is asynchronous</li>
</ul>
</li>
<li>
<p><em>Exposing Legacy Systems as Services</em></p>
<ul>
<li>aka Open Host Service Pattern</li>
</ul>
</li>
</ul>
</div>
<div class='right' style='float:right;width:50%'>
<img src="assets/legacy_integration.png" style='
    width: 30vw;
    
    max-width: 95vw;
    max-height: 80vh;
    object-fit: contain;
'>

<p><a href="https://www.domainlanguage.com/ddd/surrounded-by-legacy-software">www.domainlanguage.com/ddd/surrounded-by-legacy-software</a></p>
</div>
</section><section>
<h1 id="integration-strategies">Integration Strategies</h1>
<h1 id="for-distributed-bounded-contexts">for Distributed Bounded Contexts</h1>
<div class='left' style='float:left;width:50%'>
<p>When bounded contexts are separate services that communicate with each other over the network we have a distributed system.</p>
<p>In these systems, choosing the wrong integration strategy might cause slow or unreliable systems that lead to negative business impacts!</p>
</div>
<div class='right' style='float:right;width:50%'>
<ul>
<li>
<p><strong>Bad Practices</strong></p>
<ul>
<li>Database and/or Flat File Integration</li>
<li>Remote Procedure Call (RPC)</li>
</ul>
</li>
<li>
<p><strong>Good Practices</strong></p>
<ul>
<li>Messaging</li>
<li>REST</li>
</ul>
</li>
</ul>
</div>
</section><section>
<h2 id="the-old-rpc-scenario">The (old) RPC Scenario</h2>
<img src="assets/distributed_rpc_scenario.png" style='
    
    
    max-width: 95vw;
    max-height: 80vh;
    object-fit: contain;
'>

</section><section>
<h2 id="event-driven-reactive-ddd">Event-Driven Reactive DDD</h2>
<img src="assets/distributed_reactive_scenario.png" style='
    
    
    max-width: 95vw;
    max-height: 80vh;
    object-fit: contain;
'>

</section><section>
<h2 id="service-oriented-architectures--reactive-ddd">Service-Oriented Architectures &amp; Reactive DDD</h2>
<blockquote>
<p><em><strong>Reactive programming</strong> is a set of low‐level technical guidelines that lead to loosely-coupled software components</em></p>
</blockquote>
<blockquote>
<p><em><strong>SOA</strong> is a high‐level concept that facilitates loosely coupled business capabilities</em></p>
</blockquote>
<p>The combination of the two appears an optimal direction for the DDD approach!</p>
</section><section>
<h2 id="soa--reactive-ddd">SOA &amp; Reactive DDD</h2>
<div class='left' style='float:left;width:50%'>
<ul>
<li>
<p>How to combine these benefits with DDD?</p>
<ul>
<li><strong>View your bounded contexts as SOA services, so that you can map high‐level bounded contexts onto low‐level, event‐driven software components</strong></li>
</ul>
</li>
<li>
<p>Combining SOA and reactive programming provides a platform to:</p>
<ul>
<li>align your infrastructure with business priorities</li>
<li>deal with scalability and reliability challenges</li>
<li>organize your teams by aligning them with bounded contexts to reduce communication overhead</li>
</ul>
</li>
</ul>
</div>
<div class='right' style='float:right;width:50%'>
<img src="assets/soa_and_reactive.png" style='
    width: 45vw;
    
    max-width: 95vw;
    max-height: 80vh;
    object-fit: contain;
'>

</div>
</section><section>
<h2 id="domain-driven-design--rest">Domain-Driven Design &amp; REST</h2>
<ul>
<li>
<p><strong>Resources</strong> - fit well with DDD because domain concepts can be expressed as resources, further spreading the UL</p>
<ul>
<li>E.g. In a financial domain, transactions that transfer funds from one account to another
<ul>
<li>The UL has an entry for each type of transaction, such as <em>B2B Transaction</em> or <em>Personal Transaction</em>, that become resources accessible from proper URIs
<ul>
<li><code>http://mydomain.com/B2bTransactions</code></li>
<li><code>http://mydomain.com/PersonalTransactions</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Hypermedia</strong> - an opportunity for DDD to express the domain concepts more explicitly</p>
<ul>
<li>E.g. In a car insurance policy, each step of the application process could be expressed as links in hypermedia to the next possible steps, according with the UL terminology</li>
<li>It can be used to model also workflows or domain processes</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="bounded-context-integration-via-rest">Bounded Context Integration via REST</h2>
<ul>
<li>
<p><em>Be careful!</em> - A direct exposition of the domain model via RESTful API might be brittle!</p>
<ul>
<li><strong>Each change in the domain model is directly reflected in the system interface</strong></li>
</ul>
</li>
<li>
<p>A viable solution</p>
<ul>
<li>introduce a separate Bounded Context for the system&rsquo;s interface layer and use appropriate strategies to access the actual Core Domain from the system&rsquo;s interface model</li>
<li>so, the Core Domain is decoupled from the system&rsquo;s interface model</li>
<li>the interface model must be driven by the use cases</li>
</ul>
</li>
<li>
<p>A step further</p>
<ul>
<li>CQRS - Command Query Responsibility Segregation</li>
</ul>
</li>
</ul>
</section>

  


</div>
      

    </div>
<script type="text/javascript" src=/Course-Laboratory-of-Software-Systems/reveal-hugo/object-assign.js></script>

<a href="/Course-Laboratory-of-Software-Systems/reveal-js/css/print/" id="print-location" style="display: none;"></a>
<script type="text/javascript">
  var printLocationElement = document.getElementById('print-location');
  var link = document.createElement('link');
  link.rel = 'stylesheet';
  link.type = 'text/css';
  link.href = printLocationElement.href + (window.location.search.match(/print-pdf/gi) ? 'pdf.css' : 'paper.css');
  document.getElementsByTagName('head')[0].appendChild(link);
</script>

<script type="application/json" id="reveal-hugo-site-params">{"height":"100%","pdfseparatefragments":false,"theme":"white","width":"100%"}</script>
<script type="application/json" id="reveal-hugo-page-params">{"custom_theme":"custom-theme.scss","custom_theme_compile":true,"custom_theme_options":{"enablesourcemap":true,"targetpath":"css/custom-theme.css"},"transition":"slide","transition_speed":"fast"}</script>

<script src="/Course-Laboratory-of-Software-Systems/reveal-js/js/reveal.js"></script>

<script type="text/javascript">
  
  
  function camelize(map) {
    if (map) {
      Object.keys(map).forEach(function(k) {
        newK = k.replace(/(\_\w)/g, function(m) { return m[1].toUpperCase() });
        if (newK != k) {
          map[newK] = map[k];
          delete map[k];
        }
      });
    }
    return map;
  }
  
  var revealHugoDefaults = { center: true, controls: true, history: true, progress: true, transition: "slide" };
  var revealHugoSiteParams = JSON.parse(document.getElementById('reveal-hugo-site-params').innerHTML);
  var revealHugoPageParams = JSON.parse(document.getElementById('reveal-hugo-page-params').innerHTML);
  
  var options = Object.assign({},
    camelize(revealHugoDefaults),
    camelize(revealHugoSiteParams),
    camelize(revealHugoPageParams));
  Reveal.initialize(options);
</script>


  
  
  <script type="text/javascript" src="/Course-Laboratory-of-Software-Systems/reveal-js/plugin/markdown/marked.js"></script>
  
  <script type="text/javascript" src="/Course-Laboratory-of-Software-Systems/reveal-js/plugin/markdown/markdown.js"></script>
  
  <script type="text/javascript" src="/Course-Laboratory-of-Software-Systems/reveal-js/plugin/highlight/highlight.js"></script>
  
  <script type="text/javascript" src="/Course-Laboratory-of-Software-Systems/reveal-js/plugin/zoom-js/zoom.js"></script>
  
  
  <script type="text/javascript" src="/Course-Laboratory-of-Software-Systems/reveal-js/plugin/notes/notes.js"></script>



    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
</script>

<script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

    
  </body>
</html>
